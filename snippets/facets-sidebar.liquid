<facet-filters-form class="{{ class }}">
  <form id="FacetFiltersForm" method="get" class="facet-filters-form position-static">
    {%- if collection.terms -%}
      <input type="hidden" name="q" value="{{ collection.terms | escape }}">
      <input name="options[prefix]" type="hidden" value="last">
    {%- endif -%}
    <div class="canvas-filter {{ filter_class }}" id="filterShop">
      <div class="canvas-wrapper">
        <div class="canvas-header {{ header_class }}">
          <span class="title h3 fw-medium">Filter</span>
          <drawer-close-button>
            <button type="button" class="icon-close link icon-close-popup fs-24" data-bs-dismiss="offcanvas"></button>
          </drawer-close-button>
        </div>

        {%- assign filter_scope = scope | default: 'Desktop' -%}

        <div class="canvas-body">
          {% for filter in collection.filters %}
            <div class="widget-facet js-filter" id="Filter-{{ filter.param_name | handle }}">
              <div
                class="facet-title"
                data-bs-target="#filter-{{ filter.param_name | handle }}"
                role="button"
                data-bs-toggle="collapse"
                aria-expanded="true"
              >
                <span class="h4 fw-semibold">{{ filter.label }}</span>
                <span class="icon icon-caret-down fs-20"></span>
              </div>

              <div id="filter-{{ filter.param_name | handle }}" class="collapse show">
                {% case filter.type %}
                  {% when 'list' %}
                    {%- assign filter_label = filter.label | downcase -%}

                    {%- if filter_label == 'color' -%}
                      <!-- COLOR (swatches) -->
                      <div class="collapse-body filter-color-box flat-check-list">
                        {% for value in filter.values %}
                          <label
                            class="check-item color-item color-check position-relative {% if value.active %}active{% endif %}"
                            for="Filter-{{ filter_scope }}-{{ filter.label | escape }}-{{ forloop.index }}"
                          >
                            <input
                              type="checkbox"
                              id="Filter-{{ filter_scope }}-{{ filter.label | escape }}-{{ forloop.index }}"
                              name="{{ value.param_name }}"
                              value="{{ value.value }}"
                              class="appearance-hidden"
                              {% if value.active %}
                                checked
                              {% endif %}
                              {% if value.count == 0 and value.active == false %}
                                disabled
                              {% endif %}
                            >
                            {%- assign color_rgb = value.swatch.color.rgb | default: '' -%}
                            <span
                              class="color"
                              style="
                                {% if color_rgb != blank %}
                                  background-color: rgb({{ color_rgb }}) !important;
                                {% else %}
                                  background-color: {{ value.value }} !important;
                                {% endif %}
                              "
                            ></span>
                            <span class="color-text">{{ value.label | escape }}</span>
                          </label>
                        {% endfor %}
                      </div>

                    {%- elsif filter_label == 'size' -%}
                      <!-- SIZE (boxes) -->
                      <div class="collapse-body filter-size-box flat-check-list">
                        {% for value in filter.values %}
                          <label
                            class="check-item size-item size-check position-relative {% if value.active %}active{% endif %}"
                            for="Filter-{{ filter_scope }}-size-{{ forloop.index }}"
                          >
                            <input
                              type="checkbox"
                              id="Filter-{{ filter_scope }}-size-{{ forloop.index }}"
                              name="{{ value.param_name }}"
                              value="{{ value.value }}"
                              class="appearance-hidden"
                              {% if value.active %}
                                checked
                              {% endif %}
                              {% if value.count == 0 and value.active == false %}
                                disabled
                              {% endif %}
                            >
                            <span class="size h6">{{ value.label }}</span>
                          </label>
                        {% endfor %}
                      </div>

                    {%- else -%}
                      <!-- DEFAULT LIST (brand, availability, etc.) -->
                      <ul class="collapse-body filter-group-check current-scrollbar">
                        {% for value in filter.values %}
                          <li class="list-item {% if value.count == 0 and value.active == false %}disabled{% endif %}">
                            <input
                              type="checkbox"
                              class="tf-check"
                              name="{{ value.param_name }}"
                              value="{{ value.value }}"
                              id="Filter-{{ filter_scope }}-{{ value.param_name | handle }}-{{ forloop.index }}"
                              {% if value.active %}
                                checked
                              {% endif %}
                              {% if value.count == 0 and value.active == false %}
                                disabled
                              {% endif %}
                            >
                            <label for="Filter-{{ filter_scope }}-{{ value.param_name | handle }}-{{ forloop.index }}" class="label">
                              <span>{{ value.label }}</span>
                              <span class="count">{{ value.count }}</span>
                            </label>
                          </li>
                        {% endfor %}
                      </ul>
                    {%- endif -%}

                  {% when 'price_range' %}
                    {% comment %} checkpoints {% endcomment %}
                    <div class="price-range-filter">
                      <!-- Price range filter content would go here -->
                      <div class="widget-facet">
                        <div id="price" class="collapse show">
                          {% render 'facets-price-range', filter: filter %}
                        </div>
                      </div>
                    </div>
                {% endcase %}
              </div>
            </div>
          {% endfor %}
        </div>

        <div class="canvas-bottom {{ bottom_class }}">
          <facet-remove>
            <a href="{{ collection.url }}" class="tf-btn btn-reset w-100"> Reset Filters </a>
          </facet-remove>
        </div>
      </div>
    </div>
  </form>
</facet-filters-form>
